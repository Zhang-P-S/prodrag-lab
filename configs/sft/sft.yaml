setting: sft_localv2

paths:
  qa_jsonl: data/eval/qa_v1_200.jsonl
  run_out: artifacts/rag_eval/sft_localv2.jsonl
  index_dir: data/index

llm:
  backend: local
  local:
    model_path: /home/zps/models/llm/models--unsloth--DeepSeek-R1-Distill-Qwen-7B-bnb-4bit/snapshots/5c46879548e720d7b7d640251a09926b92627fcd
    # 这里填你 LoRA 输出目录（里面一般有 adapter_model.safetensors / adapter_config.json）
    lora_path: /home/zps/docker-demo/saves/DeepSeek-R1-7B-Distill/lora/train_2026-02-14-16-33-18
    dtype: float16
    device: cuda

eval:
  seed: 42
  max_items: 200
  dual_lang: true
  flush_every: 10

gen:
  # SFT 后建议更“硬”一点，先把格式/引用对齐做出来
  max_tokens: 256
  temperature: 0.0
  top_p: 1.0

retrieval:
  dense_topk: 15
  bm25_topk: 15
  merge_topk: 30
  fusion_topk: 60
  rerank_topk: 8

  fusion_en_ratio: 0.5
  rerank_en_ratio: 0.5
  min_en_candidates: 10
  min_zh_candidates: 10

controls:
  enable_rerank: true
  enable_refusal: true
  refusal_threshold: 0.7
  margin_threshold: 0.3

  # SFT 效果验证阶段：必须关掉，才能看到模型是否真的学会 citations
  autofill_citations: false
  autofill_topk: 4

  max_chunk_chars: 1200
  max_ctx_chars: 8000
